---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import FormattedDate from '../components/FormattedDate.astro';
import { getCollection } from 'astro:content';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { tagToSlug } from '../lib/slug';
import heroTiles from '../assets/patterns/hero-tiles.svg?url';

// Thumbnails with runtime-safe lazy imports (avoid missing-file crashes in dev)
const thumbs = import.meta.glob('../assets/thumbs/*.svg', { query: '?url', import: 'default' });
async function getThumb(id: string) {
  const key = `../assets/thumbs/${id}.svg`;
  const def = `../assets/thumbs/default.svg`;
  const loader = (thumbs as Record<string, () => Promise<string>>)[key] || (thumbs as Record<string, () => Promise<string>>)[def];
  return await loader();
}

const allPosts = await getCollection('blog');
const latestPosts = allPosts
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
    .slice(0, 8);
const latestWithThumbs = await Promise.all(latestPosts.map(async (p) => ({ ...p, thumb: await getThumb(p.id) })));

// Compute tag cloud data
const tagCounts = new Map<string, number>();
for (const p of allPosts) {
  const tags = Array.isArray(p.data.tags) ? p.data.tags : [];
  for (const t of tags) tagCounts.set(t, (tagCounts.get(t) ?? 0) + 1);
}
const tags = [...tagCounts.entries()].sort((a, b) => a[0].localeCompare(b[0], 'sk'));
const allTags = [...tagCounts.entries()].sort((a, b) => a[0].localeCompare(b[0], 'sk'));
const counts = tags.map(([, c]) => c);
const minCount = counts.length ? Math.min(...counts) : 0;
const maxCount = counts.length ? Math.max(...counts) : 0;
const scale = (c: number) => {
  if (minCount === maxCount) return 1.0;
  const t = (c - minCount) / (maxCount - minCount);
  return 0.9 + t * 0.6; // 0.9em .. 1.5em
};

// Compute categories with at least one post
const catCounts = new Map<string, number>();
for (const p of allPosts) {
  const cats = Array.isArray(p.data.categories) ? p.data.categories : [];
  for (const c of cats) catCounts.set(c, (catCounts.get(c) ?? 0) + 1);
}
const allCategories = [...catCounts.entries()].sort((a, b) => a[0].localeCompare(b[0], 'sk'));
---

<!doctype html>
<html lang="sk">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
			<style>
				.hero h1 { font-size: clamp(2.5rem, 4vw, 4rem); }
				.hero p.lead { font-size: clamp(1.1rem, 2vw, 1.35rem); }
				/* Prevent horizontal overflow on narrow screens */
				.stop-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(min(100%, 360px), 1fr)); gap: 1rem; margin-top: 1.5rem; }
				.stop-card { text-align: center; }
				.latest-posts { margin-top: 3rem; }
				.posts { display: grid; grid-template-columns: repeat(auto-fit, minmax(min(100%, 360px), 1fr)); gap: 1rem; list-style: none; padding: 0; margin: 0; }
				.posts li a { display: block; text-decoration: none; }
				.posts li img, .posts li svg { display: block; width: 100%; height: auto; margin-bottom: 14px; border-radius: 12px; }
				.posts li .title { margin: 0; color: rgb(var(--black)); }
				.posts li .date { margin: 0; color: rgb(var(--gray)); }
				/* On hover, only adjust date; keep title color unchanged */
				.posts li:hover .date { color: rgb(var(--accent)); }
				.posts li:hover img, .posts li:hover svg { box-shadow: var(--box-shadow); }
				
				.lead{font-size: 1.5em; font-weight:200;}

				/* Hero background: seamless SVG tile at ~20% opacity 
				.herobcg { position: relative;}
				.herobcg::before {
					content: "";
					position: fixed;
					top:0px;
					inset: 0;
					background-image: background-image: url("data:image/svg+xml,%3c?xml%20version=%271.0%27%20encoding=%27UTF-8%27?%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20viewBox=%270%200%20720%20360%27%20role=%27img%27%20aria-label=%27Abstraktn%C3%BD%20geometrick%C3%BD%20n%C3%A1h%C4%BEad%27%3e%3cdefs%3e%3clinearGradient%20id=%27bg-grad%27%20x1=%270%27%20y1=%270%27%20x2=%27720%27%20y2=%270%27%20gradientUnits=%27userSpaceOnUse%27%20gradientTransform=%27rotate(92,%20360,%20180)%27%3e%3cstop%20offset=%270%25%27%20stop-color=%27%239bb5c0%27%20/%3e%3cstop%20offset=%27100%25%27%20stop-color=%27%239ac2ab%27%20/%3e%3c/linearGradient%3e%3cclipPath%20id=%27rounded%27%3e%3crect%20x=%270%27%20y=%270%27%20width=%27720%27%20height=%27360%27%20rx=%2721.599999999999998%27%20ry=%2721.599999999999998%27%20/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path=%27url(%23rounded)%27%3e%3crect%20x=%270%27%20y=%270%27%20width=%27720%27%20height=%27360%27%20fill=%27url(%23bg-grad)%27%20/%3e%3cg%20transform=%27translate(223.54144239798188%20262.7468216121197)%20rotate(304)%27%3e%3crect%20x=%27-183.71791180458217%27%20y=%27-211.62879339362425%27%20width=%27367.43582360916434%27%20height=%27423.2575867872485%27%20fill=%27%23EDDD53%27%20opacity=%270.51%27/%3e%3c/g%3e%3cpolygon%20points=%27515.5430828422279,336.6444123603214%20472.6337369095445,286.39091282619006%20463.875157964918,218.56183731809685%20523.0342791343654,172.6903722506763%20575.5198872598369,217.14531317301157%20625.3014814583042,264.2873144411222%20579.3482938131247,317.94595368926525%27%20fill=%27%232A7B9B%27%20opacity=%270.39%27%20/%3e%3cpolygon%20points=%27459.8077957642742,-15.748203315083266%20551.6540883560585,-24.96296283051111%20619.6536404077073,46.046042466826236%20584.4164046893937,149.19305720964607%20484.0089848086959,134.94217882963855%20433.2439798999395,69.1656425954389%27%20fill=%27none%27%20stroke=%27%2357C785%27%20stroke-width=%273.28432125762105%27%20stroke-linejoin=%27round%27%20opacity=%270.52%27%20/%3e%3ccircle%20cx=%27195.17661060020325%27%20cy=%2759.32126541063189%27%20r=%2769.29297211091715%27%20fill=%27hsl(0%200%25%2085%25)%27%20opacity=%270.59%27%20/%3e%3c/g%3e%3c/svg%3e");
					background-repeat: no-repeat;
					background-size: cover;
					opacity: 0.4; 
					z-index: 0;
					pointer-events: none;
				}
				.herobcg > * { position: relative; z-index: 1; }*/

				/* Fix: keep background fixed but only within herobcg; do not overlay page */
				.herobcg::before { content: none !important; }
				.herobcg {
					background-image: linear-gradient(rgba(255,255,255,0.8), rgba(255,255,255,0.8)), url("data:image/svg+xml,%3c?xml%20version=%271.0%27%20encoding=%27UTF-8%27?%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20viewBox=%270%200%20720%20360%27%20role=%27img%27%20aria-label=%27Abstraktn%C3%BD%20geometrick%C3%BD%20n%C3%A1h%C4%BEad%27%3e%3cdefs%3e%3clinearGradient%20id=%27bg-grad%27%20x1=%270%27%20y1=%270%27%20x2=%27720%27%20y2=%270%27%20gradientUnits=%27userSpaceOnUse%27%20gradientTransform=%27rotate(92,%20360,%20180)%27%3e%3cstop%20offset=%270%25%27%20stop-color=%27%239bb5c0%27%20/%3e%3cstop%20offset=%27100%25%27%20stop-color=%27%239ac2ab%27%20/%3e%3c/linearGradient%3e%3cclipPath%20id=%27rounded%27%3e%3crect%20x=%270%27%20y=%270%27%20width=%27720%27%20height=%27360%27%20rx=%2721.599999999999998%27%20ry=%2721.599999999999998%27%20/%3e%3c/clipPath%3e%3c/defs%3e%3cg%20clip-path=%27url(%23rounded)%27%3e%3crect%20x=%270%27%20y=%270%27%20width=%27720%27%20height=%27360%27%20fill=%27url(%23bg-grad)%27%20/%3e%3cg%20transform=%27translate(223.54144239798188%20262.7468216121197)%20rotate(304)%27%3e%3crect%20x=%27-183.71791180458217%27%20y=%27-211.62879339362425%27%20width=%27367.43582360916434%27%20height=%27423.2575867872485%27%20fill=%27%23EDDD53%27%20opacity=%270.51%27/%3e%3c/g%3e%3cpolygon%20points=%27515.5430828422279,336.6444123603214%20472.6337369095445,286.39091282619006%20463.875157964918,218.56183731809685%20523.0342791343654,172.6903722506763%20575.5198872598369,217.14531317301157%20625.3014814583042,264.2873144411222%20579.3482938131247,317.94595368926525%27%20fill=%27%232A7B9B%27%20opacity=%270.39%27%20/%3e%3cpolygon%20points=%27459.8077957642742,-15.748203315083266%20551.6540883560585,-24.96296283051111%20619.6536404077073,46.046042466826236%20584.4164046893937,149.19305720964607%20484.0089848086959,134.94217882963855%20433.2439798999395,69.1656425954389%27%20fill=%27none%27%20stroke=%27%2357C785%27%20stroke-width=%273.28432125762105%27%20stroke-linejoin=%27round%27%20opacity=%270.52%27%20/%3e%3ccircle%20cx=%27195.17661060020325%27%20cy=%2759.32126541063189%27%20r=%2769.29297211091715%27%20fill=%27hsl(0%200%25%2085%25)%27%20opacity=%270.59%27%20/%3e%3c/g%3e%3c/svg%3e");
					background-repeat: no-repeat;
					background-repeat: no-repeat, repeat;
					background-size: auto, cover;
					background-attachment: scroll, fixed;
				}
			</style>
	</head>
	<body>
		<Header />
		<main class="mx-auto mt-0 pt-0 max-w-4xl px-4 sm:px-6 lg:px-8">
		<section class="herobcg full-bleed pt-8 pb-[2.5em] mt-0 min-h-[800px] mb-24" style="box-shadow:inset 0px -20px 20px #0000000d;" style={`--hero-bg: url(${heroTiles});`}>
			<div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
			<section class="hero text-center">
				<h1 class="mx-auto my-20 text-3xl !leading-tight sm:text-4xl md:text-5xl"><span class="font-light">Spomaľ. Mysli. Overuj.</span> <br/>Kritické myslenie v bežnom živote.</h1>
			</section>
			<section>
				
				<p class="text-2xl font-light headingfont">Svet je preplnený informáciami. <b>Ale informácie sa nemusia rovnať pravde.</b> Každý má „svoju pravdu“, niečo zdieľa, niečo komentuje, niečomu verí. 
					A je úplne normálne, ak sa v tom človek občas stratí.</p>
				<p class="text-2xl font-light headingfont"><strong>Kriticky.sk</strong> je miesto pre každého, kto si kladie otázky. Kto je <em>zdravo</em> skeptický.
					Kto nechce hneď uveriť všetkému, ale ani hneď všetko odmietať. Kto chce rozumieť svetu okolo seba – a naučiť sa rozlišovať fakty od domnienok, emócie od reality.</p>
			</section>
			</div>
		</section>

			<section class="full-bleed">
				<div class="mx-1 md:mx-8 grid gap-6 md:gap-8 grid-cols-1 md:grid-cols-2 lg:grid-cols-4">
				<div class="stop-card -top-36 relative fancybox ">
					<h3><span style="font-size: 2em;">S</span><br/>Skontroluj zdroj</h3>
					<p>Kto to tvrdí? Je to dôveryhodný zdroj? Má meno, odbornú autoritu, minulosť v klamstvách?</p>
				</div>
				<div class="stop-card -top-36 relative fancybox">
					<h3><span style="font-size: 2em;">T</span><br/>Triezvo premýšľaj</h3>
					<p>Nehrá to na tvoje emócie? Znie to príliš dobre/zle na to, aby to bola pravda?</p>
				</div>
				<div class="stop-card -top-36 relative  fancybox">
					<h3><span style="font-size: 2em;">O</span><br/>Over fakty</h3>
					<p>Dajú sa tvrdenia potvrdiť z viacerých nezávislých zdrojov? Je k tomu dôkaz, štúdia, reálne čísla?</p>
				</div>
				<div class="stop-card -top-36 relative  fancybox">
					<h3><span style="font-size: 2em;">P</span><br/>Pozor na vlastnú zaujatosť (bias)</h3>
					<p>Nehľadáš len to, čo potvrdzuje tvoje názory? Neodmietaš niečo len preto, že s tým nesúhlasíš?</p>
				</div>
				
				</div>
				<div 
				class="bg-black p-8 md:px-10 md:py-10 -mt-24 mb-24 mx-auto max-w-5xl rounded-lg flex flex-col items-center text-center">
				<h5 class="text-white text-4xl md:text-6xl tracking-tight">
					Kto myslí, ten STOP-ne.
				</h5>
				</div>
			</section>

				
			
			
			<blockquote>
				<p>„Múdry človek porovnáva svoje tvrdenia s dôkazmi.“</p>
				<footer><cite>David Hume</cite></footer>
			  </blockquote>

			  <section class="latest-posts full-bleed mt-12">
				<div class="mx-0 md:mx-8">
				<h2>Najnovšie články</h2>
				{allCategories.length > 0 && (
					<div class="mt-2 mb-4">
						<ul class="flex flex-wrap gap-2 p-0 m-0 list-none" aria-label="Kategórie">
							{allCategories.map(([c, count]) => (
								<li>
									<a class="inline-block bg-gray-200 text-gray-800 rounded-full px-2 py-0.5 no-underline mr-1" href={`/categories/${tagToSlug(c)}/`}>{c} <span class="text-gray-500 ml-1 text-sm">({count})</span></a>
								</li>
							))}
						</ul>
					</div>
				)}
				<ul class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 list-none p-0 m-0">
					{
						latestWithThumbs.map((post) => (
							<li class="glass p-3 rounded-[14px]">
								<a class="block group no-underline" href={`${import.meta.env.BASE_URL}blog/${post.id}/`}>
									<img class="w-full h-auto rounded-[12px] mb-3" src={post.thumb} alt="" />
									<h4 class="title">{post.data.title}</h4>
									<p class="date group-hover:text-[var(--accent)]">
										<FormattedDate date={post.data.pubDate} />
									</p>
								</a>
							</li>
						))
					}
				</ul>
				<p class="view-all"><a href={`${import.meta.env.BASE_URL}blog/`}>Zobraziť všetky články →</a></p>
				</div>
			</section>

			{tags.length > 0 && (


			<section class="tag-cloud full-bleed mt-2 pt-4 border-t border-gray-200">
			  <div class="mx-0 md:mx-8">
			  <h3>Podľa tém</h3>
			  <ul class="flex flex-wrap gap-2 sm:gap-3 md:gap-6 items-baseline p-0 m-0 list-none">
				{allTags.map(([t, c]) => (
				  <li>
					<a class="inline-block bg-gray-200 text-gray-800 rounded-full px-3 py-1 no-underline hover:bg-gray-300" href={`/tags/${tagToSlug(t)}/`}>{t} <span class="text-gray-500 ml-1 text-sm">({c})</span></a>
				  </li>
				))}
			  </ul>
			  </div>
			</section>
			)}

<section class="fancybox p-6 mt-4">
	<h2>🛑 SI TU PRVÝ KRÁT? ZAČNI TAKTO:</h2>
	<p>Odporúčané čítanie predtým, než sa ponoríš do článkov:</p>
	<p><strong>S</strong> – <strong>Skontroluj zdroj</strong><br/>
	<strong>T</strong> – <strong>Triezvo premýšľaj</strong><br/>
	<strong>O</strong> – <strong>Over fakty</strong><br/>
	<strong>P</strong> – <strong>Pozor na vlastnú zaujatosť</strong></p>

	<p>Týchto 4 krokov ti môže ušetriť nielen trapas na Facebooku, ale aj názor, ktorého by si mohol časom ľutovať.</p>
</section>

				<div class="bg-black p-8 md:px-20 md:py-20 mt-20 mx-auto max-w-5xl rounded-lg flex flex-col items-center text-center">
				<h2 class="text-white text-4xl md:text-6xl tracking-tight">
				Čo myslíme pod kritickým myslením?
				</h2>
				<p class="text-slate-400 mt-4 text-lg md:text-xl">
				Kritické myslenie nie je o tom byť "múdrejší" než ostatní.<br/>Je to zručnosť, ktorú si môže rozvíjať každý – či má 16 alebo 60.
				<br/>Ide len o to, <strong>spomaliť, pozrieť sa na veci s odstupom a položiť si zopár otázok</strong>.
				</p>
				<div class="flex mt-5">
				<a class="btn btn-light" href="/kriticke-myslenie">Viac o kritickom myslení</a>
				</div>
				</div>


			<section class="fancybox p-6 mt-4">
				<h2>🛑 Metóda STOP</h2>
				<p>Jednoduchý nástroj, ktorý ti pomôže, keď niečo znie až príliš dobre (alebo zle) na to, aby to bola pravda:</p>
				<p><strong>S</strong> – <strong>Skontroluj zdroj</strong><br/>
				<strong>T</strong> – <strong>Triezvo premýšľaj</strong><br/>
				<strong>O</strong> – <strong>Over fakty</strong><br/>
				<strong>P</strong> – <strong>Pozor na vlastnú zaujatosť</strong></p>

				<p>Týchto 4 krokov ti môže ušetriť nielen trapas na Facebooku, ale aj názor, ktorého by si mohol časom ľutovať.</p>
			</section>

			<blockquote>
				<p>Information is not the same as truth. Most information is not an accurate representation of reality. 
				The main role information plays is to connect many things, to connect people. Sometimes people are connected by truth, 
				but often it is easier to use fiction or illusion.</p>
				<footer><cite>Yuval Noah Harari</cite></footer>
				
			</blockquote>

			<section class="fancybox p-6 mt-4" >
				<h2>Čo tu nájdeš?</h2>
				<p>🧩 <strong>Príklady z praxe</strong><br/>Reálne príklady z médií, sociálnych sietí, politiky – rozobrané jednoducho, bez poučovania.</p>
				<p>🔍 <strong>Návody a techniky</strong><br/>Ako si overiť informácie, ako spoznať zavádzanie, ako si dať pozor na vlastné chyby v uvažovaní.</p>
				<p>🧠 <strong>Zaujímavosti o ľudskej mysli</strong><br/>Prečo nás lákajú jednoduché riešenia? Prečo si niektoré názory chránime ako keby boli naše deti? (A čo s tým?)</p>
			</section>

			<section class="fancybox p-6 mt-4" >
				<h2>Prečo to robíme?</h2>
				<p>Lebo veríme, že <strong>kritické myslenie patrí do každodenného života</strong>.<br/>
				Nie ako školská poučka, ale ako užitočný kompas pre dobu, kde sa informácie šíria rýchlejšie než rozum.</p>
				<p>Nechceme ti hovoriť, čo si máš myslieť.<br/>
				Chceme ti pomôcť <strong>rozpoznať, kedy sa oplatí myslieť viac.</strong></p>
				<p>Vitaj.</p>
				<p>A hlavne –<br/>
					<strong>Spomaľ. Mysli. Overuj.</strong></p>
			</section>


			
		</main>

			
		<Footer />
	</body>
</html>
