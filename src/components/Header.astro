---
import Navbar from './navbar/navbar.astro';
---
<div class="header-sentinel" aria-hidden="true"></div>
<div class="site-header sticky top-0 z-[1000] bg-white shadow">
  <div class="mx-auto max-w-7xl sm:px-6 lg:px-8">
    <div>
      <Navbar />
    </div>
  </div>
  <style>
    /* Preserve old sitename look inside the new navbar */
    .sitename a { font-size: 1.7em; font-weight: 600; color: rgb(var(--black)); text-decoration: none; }
    /* Containerized header using Tailwind; no custom grid needed */
    /* Subtle slide-in when the header becomes sticky */
    .site-header.is-sticky-enter { animation: headerSlideIn 360ms ease-out forwards; }
    @keyframes headerSlideIn { from { transform: translateY(-100%); } to { transform: translateY(0); } }
    @media (prefers-reduced-motion: reduce) {
      .site-header.is-sticky-enter { animation: none; }
    }
  </style>
</div>
<script is:inline>
  (function () {
    try {
      var header = document.querySelector('.site-header');
      var sentinel = document.querySelector('.header-sentinel');
      if (!header || !sentinel || !('IntersectionObserver' in window)) return;

      var io = new IntersectionObserver(function (entries) {
        entries.forEach(function (entry) {
          if (entry.isIntersecting) {
            header.classList.remove('is-sticky');
          } else {
            header.classList.add('is-sticky');
            header.classList.add('is-sticky-enter');
            header.addEventListener('animationend', function () {
              header.classList.remove('is-sticky-enter');
            }, { once: true });
          }
        });
      });
      io.observe(sentinel);
    } catch (e) { /* ignore */ }
  })();
</script>
