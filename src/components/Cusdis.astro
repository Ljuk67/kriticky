---
// Cusdis comments embed with Slovak UI.
// Requires a Cusdis Site App ID set in env as PUBLIC_CUSDIS_APP_ID.
// Props:
// - pageId: unique id per page (e.g., slug)
// - pageUrl: canonical URL (string)
// - pageTitle: title (string)
interface Props {
  pageId: string;
  pageUrl: string;
  pageTitle: string;
}
const { pageId, pageUrl, pageTitle } = Astro.props as Props;
const appId = import.meta.env.PUBLIC_CUSDIS_APP_ID;
---

<section aria-label="Komentáre">
  {appId ? (
    <>
      <style is:inline>
        {`
          /* Make the comment iframe tall enough to avoid inner scrolling */
          #cusdis_thread { min-height: 900px; }
          #cusdis_thread iframe { height: 900px !important; min-height: 900px !important; width: 100% !important; }
        #cusdis_thread {
display: flex;
height: 40em; // you can change to different value
}
        `}
      </style>
      <script is:inline>
        {`
          // Provide Slovak UI and force language to 'sk'
          window.CUSDIS_LANG = 'sk';
          window.CUSDIS_LOCALE = {
            powered_by: 'Komentáre cez Cusdis',
            post_comment: 'Pridať komentár',
            loading: 'Načítavam…',
            no_comment: 'Zatiaľ žiadne komentáre',
            send: 'Odoslať',
            reply: 'Odpovedať',
            cancel: 'Zrušiť',
            edit: 'Upraviť',
            delete: 'Vymazať',
            comment: 'Komentár',
            name: 'Meno',
            email: 'E‑mail (nepovinné)',
            website: 'Web (nepovinné)',
            message: 'Správa',
            preview: 'Náhľad',
            load_more: 'Načítať viac',
            sending: 'Odosielam…',
            submit: 'Odoslať',
            required: 'Povinné',
            // Additional keys aligned to en.js
            comment_count: '{0} komentárov',
            cancel_reply: 'Zrušiť odpoveď',
            reply_to: 'Odpovedať na {0}',
            just_now: 'práve teraz',
            seconds_ago: 'pred {0} s',
            minutes_ago: 'pred {0} min',
            hours_ago: 'pred {0} h',
            days_ago: 'pred {0} dňami',
            admin: 'Správca',
          };
        `}
      </script>
      <div
        id="cusdis_thread"
        data-host="https://cusdis.com"
        data-app-id={appId}
        data-page-id={pageId}
        data-page-url={pageUrl}
        data-page-title={pageTitle}
        data-lang="sk"
        data-theme="auto"
      >
        <script defer src={`${import.meta.env.BASE_URL}js/cusdis-sk.js`}></script>
        <script defer src="https://cusdis.com/js/cusdis.es.js"></script>
      </div>
    </>
  ) : (
    <p style="color: var(--gray); font-style: italic;">
      Komentáre sú dočasne vypnuté. Nastav <code>PUBLIC_CUSDIS_APP_ID</code> v súbore <code>.env</code>.
    </p>
  )}
  <noscript>Na zobrazenie komentárov povoľ JavaScript.</noscript>
</section>
